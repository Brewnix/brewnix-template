---
# Security and Firewall Services Configuration
# Network security, firewall management, and intrusion detection

# Core firewall services
opnsense_firewall:
  enabled: true
  vm_config:
    vcpus: 2
    memory: 4096
    disk: 32
  network:
    ip: "192.168.1.1"
    wan_interface: "wan"
    lan_interface: "lan"
  firewall_rules:
    default_deny: true
    allow_web_admin: true
    allow_ssh: true

# Intrusion Detection System
suricata_ids:
  enabled: true
  vm_config:
    vcpus: 2
    memory: 4096
    disk: 50
  network:
    ip: "192.168.1.10"
    monitor_interfaces: ["lan", "dmz"]
  rules:
    et_open: true
    emerging_threats: true
    custom_rules: true

# Network monitoring and analysis
ntopng_monitor:
  enabled: true
  vm_config:
    vcpus: 1
    memory: 2048
    disk: 30
  network:
    ip: "192.168.1.11"
  monitoring:
    interfaces: ["lan", "wan", "dmz"]
    flow_export: true
    alerting: true

# VPN services
strongswan_vpn:
  enabled: true
  vm_config:
    vcpus: 1
    memory: 2048
    disk: 20
  network:
    ip: "192.168.1.12"
  vpn_config:
    ipsec_enabled: true
    l2tp_enabled: true
    max_clients: 50

# Web Application Firewall
modsecurity_waf:
  enabled: false  # Optional component
  vm_config:
    vcpus: 2
    memory: 4096
    disk: 30
  network:
    ip: "192.168.1.13"
  protection:
    owasp_rules: true
    custom_rules: true
    ddos_protection: true

# Network access control
freeradius_nac:
  enabled: false  # Optional component
  vm_config:
    vcpus: 1
    memory: 2048
    disk: 20
  network:
    ip: "192.168.1.14"
  authentication:
    ldap_integration: false
    certificate_auth: true
    mac_address_auth: true

# Security information and event management
security_onion_siem:
  enabled: false  # Optional component
  vm_config:
    vcpus: 4
    memory: 8192
    disk: 200
  network:
    ip: "192.168.1.15"
  logging:
    log_retention: "90d"
    elasticsearch: true
    kibana: true

# DNS security and filtering
pihole_dns:
  enabled: true
  vm_config:
    vcpus: 1
    memory: 1024
    disk: 20
  network:
    ip: "192.168.1.16"
    upstream_dns: ["8.8.8.8", "8.8.4.4"]
  filtering:
    ad_blocking: true
    malware_blocking: true
    custom_blocklists: true

# Certificate authority
step_ca:
  enabled: true
  vm_config:
    vcpus: 1
    memory: 1024
    disk: 20
  network:
    ip: "192.168.1.17"
  ca_config:
    root_ca_lifetime: "10y"
    intermediate_ca_lifetime: "1y"
    certificate_lifetime: "30d"
